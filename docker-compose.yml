version: '3.7'

services:
  web:
    container_name: config_editor
    ports:
      - 4000:8000
    volumes:
      - ./configs:/iauditor_configs
    image: coderaiser/cloudcmd
    restart: unless-stopped
  exporter:
    image: sc-exporter-tool:latest
    container_name: sc-exporter-tool
    restart: unless-stopped
    environment:
      - PGID=1000
      - PUID=1000
      - 'format=sql'
    volumes:
      - type: bind
        source: ./configs
        target: /app/tools/exporter/configs
      - type: bind
        source: ./last_successful
        target: /app/tools/exporter/last_successful
      - type: bind
        source: ./exports
        target: /app/tools/exporter/exports
  portainer:
    container_name: portainer
    image: portainer/portainer
    restart: unless-stopped
    ports:
      - "9000:9000"
    command: -H unix:///var/run/docker.sock
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - iauditor_portainer_data:/data
volumes:
  iauditor_portainer_data:
  iauditor_data:
